import pytest
import requests

BASE_URL = "http://localhost:5000/api"  # Replace with your actual service URL

def test_login_success():
    payload = {
        "email": "user@example.com",
        "password": "correct_password"
    }
    response = requests.post(f"{BASE_URL}/login", json=payload)
    
    assert response.status_code == 200
    assert "token" in response.json()

def test_login_invalid_password():
    payload = {
        "email": "user@example.com",
        "password": "wrong_password"
    }
    response = requests.post(f"{BASE_URL}/login", json=payload)
    
    assert response.status_code == 401
    assert response.json().get("error") == "Invalid credentials"

def test_login_missing_fields():
    payload = {
        "email": "user@example.com"
        # password is missing
    }
    response = requests.post(f"{BASE_URL}/login", json=payload)
    
    assert response.status_code == 400
    assert "password" in response.json().get("error", "").lower()

